(function(root,factory){if(typeof module==="object"&&module.exports){module.exports=factory(require("jquery"))}else{factory(root.jQuery)}}(this,function($){var Ssi_upload=function(element,options){this.options=options;this.$element='';this.language=locale[this.options.locale];this.uploadList=[];this.totalProgress=[];this.toUpload=[];this.imgNames=[];this.totalFilesLength=0;this.successfulUpload=0;this.aborted=0;this.abortedWithError=0;this.pending=0;this.inProgress=0;this.currentListLength=0;this.inputName='';this.init(element)};Ssi_upload.prototype.init=function(element){$(element).addClass('ssi-uploadInput').after(this.$element=$('<div class="ssi-uploader">'));var $chooseBtn=$(''+'<span class="ssi-InputLabel">'+'<button class="ssi-button success">'+this.language.chooseFiles+'</button>'+'</span>').append(element);var $uploadBtn=$('<button id="ssi-uploadBtn" style="display:none !important;" class="ssi-button success ssi-hidden" >'+''+'<div id="ssi-up_loading" class="ssi-btnIn"></div></button>');var $clearBtn=$('<button id="ssi-clearBtn" class="ssi-hidden ssi-button info" >'+this.language.clear+'</button>');var $abortBtn=$('<button id="ssi-abortBtn" class="ssi-button error ssi-cancelAll ssi-hidden" ><span class="inBtn">'+this.language.abort+' </span></button>');this.$element.append($('<div class="ssi-buttonWrapper">').append($chooseBtn,$abortBtn,$uploadBtn,$clearBtn));var $uploadBox;if(!this.options.preview){this.$element.addClass('ssi-uploaderNP');var $fileList=$('<table id="ssi-fileList" class="ssi-fileList"></table>');var $namePreview=$('<span class="ssi-namePreview"></span>');var $mainBox=$('<div id="ssi-uploadFiles" class="ssi-tooltip ssi-uploadFiles '+(this.options.dropZone?'ssi-dropZone':'')+'"><div id="ssi-uploadProgressNoPreview" class="ssi-uploadProgressNoPreview"></div></div>').append($namePreview);var $uploadDetails=$('<div class="ssi-uploadDetails"></div>').append($fileList);$uploadBox=$('<div class="ssi-uploadBoxWrapper ssi-uploadBox"></div>').append($mainBox,$uploadDetails);this.$element.prepend($uploadBox)}else{$uploadBox=$('<div id="ssi-previewBox" class="ssi-uploadBox ssi-previewBox '+(this.options.dropZone?'ssi-dropZonePreview ssi-dropZone':'')+'"><div id="ssi-info">'+(this.options.dropZone?'<div id="ssi-DropZoneBack">'+this.language.drag+'</div>':'')+'<div id="ssi-fileNumber" class="ssi-hidden">?</div></div></div>');this.$element.append($uploadBox)}
var thisS=this;var $input=$chooseBtn.find(".ssi-uploadInput");this.inputName=$input.attr('name')||'files';$chooseBtn.find('button').click(function(e){e.preventDefault();$input.trigger('click')});$input.on('change',function(){thisS.toUploadFiles(this.files);$input.val('')});if(thisS.options.dropZone){$uploadBox.on("drop",function(e){e.preventDefault();$uploadBox.removeClass("ssi-dragOver");var files=e.originalEvent.dataTransfer.files;thisS.toUploadFiles(files)});$uploadBox.on("dragover",function(e){e.preventDefault();$uploadBox.addClass("ssi-dragOver");return!1});$uploadBox.on("dragleave",function(e){e.preventDefault();$uploadBox.removeClass("ssi-dragOver");return!1})}
if(!thisS.options.preview){$mainBox.click(function(){if(thisS.currentListLength>1)
$uploadDetails.toggleClass('ssi-uploadBoxOpened')})}
$clearBtn.click(function(e){e.preventDefault();thisS.clear()});$uploadBox.on('mouseenter','.ssi-statusLabel',function(e){var $eventTarget=$(e.currentTarget);var title=$eventTarget.attr('data-status');if(!title||title===''){return}
tooltip($eventTarget,title,thisS)});$uploadBox.on('mouseenter','#ssi-fileNumber',function(e){var $eventTarget=$(e.currentTarget);var message=" "+thisS.language.pending+": "+thisS.pending+" <br> "+thisS.language.completed+": "+(thisS.successfulUpload+thisS.aborted+thisS.abortedWithError)+"<br> "+thisS.language.inProgress+": "+thisS.inProgress;tooltip($eventTarget,message,thisS)});$uploadBox.on('click','.ssi-removeBtn',function(e){e.preventDefault();var $currentTarget=$(e.currentTarget);var index=$currentTarget.data('delete');thisS.pending--;thisS.currentListLength--;if(thisS.pending<1){thisS.$element.find('#ssi-fileNumber').addClass('ssi-hidden')}
if(thisS.pending===0){$uploadBtn.prop('disabled',!0)}
if(thisS.options.preview){$currentTarget.parents('table.ssi-imgToUploadTable').remove()}else{var target=$currentTarget.parents('tr.ssi-toUploadTr');$namePreview.html((thisS.currentListLength)+' files');target.prev().remove();target.remove();if(thisS.currentListLength===1){setLastElementName(thisS)}}
thisS.toUpload[index]=null;thisS.imgNames[index]=null;if(thisS.currentListLength===0){if(!thisS.options.dropZone){$uploadBox.removeClass('ssi-uploadNoDropZone')}
$clearBtn.addClass('ssi-hidden');$uploadBtn.addClass('ssi-hidden')}});$uploadBox.on('click','.ssi-abortUpload',function(e){e.preventDefault();var $eventTarget=$(e.currentTarget);var index=$eventTarget.data('delete');thisS.abort(index)});$uploadBtn.click(function(e){yoo(e)});$abortBtn.click(function(e){e.preventDefault();thisS.abortAll()});$("#upload").click(function(e){e.preventDefault();thisS.uploadFiles()})};function tooltip($target,text,thisS){$target=$($target);text=text||$target.data('title');if(!text)text=$target.attr('title');if(!text)return;var $toolTip=$('<div class="ssi-fadeOut ssi-fade ssi-tooltipText">'+text+'</div>').appendTo(thisS.$element);$target.one('mouseleave',function(){$toolTip.remove()});var offset=-16;if($target.hasClass('ssi-noPreviewSubMessage')){offset=23}
$toolTip.css({top:$target.position().top-$toolTip.height()+offset,left:$target.position().left-$toolTip.width()/2}).removeClass('ssi-fadeOut');return $toolTip}
Ssi_upload.prototype.abortAll=function(){for(var i=0;i<this.uploadList.length;i++){if(typeof this.uploadList[i]==='object'){this.abort(i)}}};Ssi_upload.prototype.toUploadFiles=function(files){if(typeof this.options.maxNumberOfFiles==='number'){if((this.inProgress+this.pending)>=this.options.maxNumberOfFiles){return}}
var thisS=this,j=0,length,imgContent='',$uploadBtn=this.$element.find('#ssi-uploadBtn'),$clearBtn=this.$element.find('#ssi-clearBtn'),$fileList=this.$element.find('#ssi-fileList'),$uploadBox=this.$element.find('.ssi-uploadBox'),imgs=[];if((this.inProgress===0&&this.pending===0)){this.clear()}
var extErrors=[],sizeErrors=[],errorMessage='';var toUploadLength,filesLength=length=toUploadLength=files.length;if(typeof this.options.maxNumberOfFiles==='number'){if(filesLength>this.options.maxNumberOfFiles-(this.inProgress+this.pending)){filesLength=toUploadLength=this.options.maxNumberOfFiles-(this.inProgress+this.pending)}}
for(var i=0;i<filesLength;i++){var file=files[i],ext=file.name.getExtension();if($.inArray(ext,this.options.allowed)===-1){if(length>filesLength){filesLength++}else{toUploadLength--}
if($.inArray(ext,extErrors)===-1){extErrors.push(ext)}}else if((file.size*Math.pow(10,-6)).toFixed(2)>this.options.maxFileSize){if(length>filesLength){filesLength++}else{toUploadLength--}
sizeErrors.push(cutFileName(file.name,ext,15))}else if($.inArray(file.name,this.imgNames)===-1){$uploadBtn.prop("disabled",!1);setupReader(file);this.pending++;this.currentListLength++}else{if(length>filesLength){filesLength++}else{toUploadLength--}}}
var extErrorsLength=extErrors.length,sizeErrorsLength=sizeErrors.length;if(extErrorsLength+sizeErrorsLength>0){if(extErrorsLength>0){errorMessage=this.language.extError.replaceText(extErrors.toString().replace(/,/g,', '))}
if(sizeErrorsLength>0){errorMessage+=this.language.sizeError.replaceText(sizeErrors.toString().replace(/,/g,', '),this.options.maxFileSize+'mb')}
this.options.errorHandler.method(errorMessage,this.options.errorHandler.error)}
function setupReader(){var index=thisS.imgNames.length;if(index===0){if(thisS.options.preview){if(!thisS.options.dropZone){$uploadBox.addClass('ssi-uploadNoDropZone')}}
$uploadBtn.removeClass('ssi-hidden');$clearBtn.removeClass('ssi-hidden')}
$clearBtn.prop('disabled',!0);thisS.toUpload[index]=file;var filename=file.name;var ext=filename.getExtension();thisS.imgNames[index]=filename;if(thisS.options.preview){var getTemplate=function(content){return'<table class="ssi-imgToUploadTable ssi-pending">'+'<tr><td class="ssi-upImgTd">'+content+'</td></tr>'+'<tr><td><div id="ssi-uploadProgress'+index+'" class="ssi-hidden ssi-uploadProgress"></div></td></tr>'+'<tr><td><button data-delete="'+index+'" class=" ssi-button error ssi-removeBtn"><span class="trash10 trash"></span></button></td></tr>'+'<tr><td>'+cutFileName(filename,ext,15)+'</td></tr></table>'};var fileType=file.type.split('/');if(fileType[0]=='image'){$uploadBtn.prop("disabled",!0);$clearBtn.prop("disabled",!0);var fileReader=new FileReader();fileReader.onload=function(){imgContent+=getTemplate('<img class="ssi-imgToUpload" src=""/><i class="fa-spin fa fa-spinner fa-pulse"></i>');imgs[index]=fileReader.result;j++;if(toUploadLength===j){thisS.$element.find('#ssi-fileNumber').removeClass('ssi-hidden');$uploadBox.append(imgContent);setTimeout(function(){setImg();$uploadBtn.prop("disabled",!1);$clearBtn.prop("disabled",!1)},10);$uploadBtn.prop("disabled",!1);$clearBtn.prop("disabled",!1);imgContent='';toUploadLength=[]}else if(toUploadLength/2==Math.round(j)){$uploadBox.append(imgContent);setImg();imgContent=''}};fileReader.readAsDataURL(file)}else{imgs[index]=null;$uploadBox.append(getTemplate('<div class="document-item" href="test.mov" filetype="'+ext+'"><span class = "fileCorner"></span></div>'));j++}}else{thisS.$element.find('.ssi-namePreview').html((index===0?cutFileName(filename,ext,13):(thisS.currentListLength+1)+' '+thisS.language.files));$fileList.append('<tr class="ssi-space"><td></td></tr>'+'<tr class="ssi-toUploadTr ssi-pending"><td><div id="ssi-uploadProgress'+index+'" class="ssi-hidden ssi-uploadProgress ssi-uploadProgressNoPre"></div>'+'<span>'+cutFileName(filename,ext,20)+'</span></td>'+'<td><a data-delete="'+index+'" class="ssi-button ssi-removeBtn  ssi-removeBtnNP"><span class="trash7 trash"></span></a></td></tr>')}
var setImg=function(){for(var i=0;i<imgs.length;i++){if(imgs[i]!==null){$uploadBox.find("#ssi-uploadProgress"+i).parents('table.ssi-imgToUploadTable').find('.ssi-imgToUpload').attr('src',imgs[i]).next().remove();imgs[i]=null}}
imgs=[]}}};var clearCompleted=function(thisS){var $completed=thisS.$element.find('.ssi-completed');thisS.successfulUpload=0;thisS.aborted=0;thisS.abortedWithError=0;if(!thisS.options.preview)$completed.prev('tr').remove();$completed.remove()};var clearPending=function(thisS){var $pending=thisS.$element.find('.ssi-pending');var length=thisS.imgNames.length;for(var i=0;i<length;i++){if(thisS.imgNames[i]===null){thisS.toUpload.splice(i,1);thisS.imgNames.splice(i,1)}}
thisS.toUpload.splice(-thisS.pending,thisS.pending);thisS.imgNames.splice(-thisS.pending,thisS.pending);thisS.pending=0;if(!thisS.options.preview)$pending.prev('tr').remove();$pending.remove()};Ssi_upload.prototype.clear=function(action){switch(action){case 'pending':clearPending(this);break;case 'completed':clearCompleted(this);break;default:clearPending(this);clearCompleted(this)}
var $uploadBtn=this.$element.find('#ssi-uploadBtn'),$clearBtn=this.$element.find('#ssi-clearBtn');this.currentListLength=getCurrentListLength(this);if(this.inProgress===0){this.totalProgress=[]}
if((this.currentListLength===0)){$clearBtn.addClass('ssi-hidden');$uploadBtn.addClass('ssi-hidden');this.$element.find('#ssi-fileNumber').addClass('ssi-hidden');this.totalFilesLength=0;if(!this.options.dropZone){this.$element.find('.ssi-uploadBox').removeClass('ssi-uploadNoDropZone')}}
$clearBtn.prop('disabled',!0);$uploadBtn.prop('disabled',!0);if(!this.options.preview){setNamePreview(this)}};var setNamePreview=function(thisS){if(thisS.currentListLength>1){thisS.$element.find('.ssi-namePreview').html(thisS.currentListLength+' files')}else if(thisS.currentListLength===1){setLastElementName(thisS)}else{thisS.$element.find('.ssi-uploadDetails').removeClass('ssi-uploadBoxOpened');thisS.$element.find('#ssi-fileList').empty();thisS.$element.find('.ssi-namePreview').empty()}};Ssi_upload.prototype.uploadFiles=function(){if(this.pending>0){if(typeof this.options.beforeUpload==='function'){try{this.options.beforeUpload()}catch(err){if(!this.options.ignoreCallbackErrors){console.log('There is an error in beforeUpload callback');return console.log(err)}}}
this.$element.find('#ssi-abortBtn').removeClass('ssi-hidden');this.$element.find('.ssi-removeBtn').addClass('ssi-abortUpload').removeClass('ssi-removeBtn').children('span').removeClass('trash7 trash10 trash').addClass((this.options.preview?'ban7w':'ban7'));var $uploadBtn=this.$element.find('#ssi-uploadBtn'),$clearBtn=this.$element.find('#ssi-clearBtn');$uploadBtn.prop("disabled",!0);var thisS=this,formData=new FormData(),i=this.totalFilesLength;if(this.totalFilesLength!==0&&!this.options.preview){setNamePreview(this)}
this.inProgress+=this.pending;this.totalFilesLength+=this.pending;this.pending=0;if(this.inProgress===this.currentListLength){$clearBtn.prop("disabled",!0)}
while(thisS.toUpload[i]===null||thisS.toUpload[i]===''){i++}
formData.append(thisS.inputName,thisS.toUpload[i]);$.each(this.options.data,function(key,value){formData.append(key,value)});thisS.$element.find('input.ssi-uploadInput').trigger('beforeUpload.ssi-uploader');ajaxLoopRequest(formData,i)}
function ajaxLoopRequest(formData,ii){var selector='table.ssi-imgToUploadTable';if(!thisS.options.preview){selector='tr.ssi-toUploadTr'}
var uploadBar=thisS.$element.find('#ssi-uploadProgress'+ii);uploadBar.removeClass('ssi-hidden').parents(selector).removeClass('ssi-pending');var ajaxOptions=$.extend({},{xhr:function(){var xhr=new window.XMLHttpRequest();xhr.upload.addEventListener('progress',function(e){if(e.lengthComputable){var percentComplete=(e.loaded/e.total)*100;if(uploadBar){uploadBar.css({width:percentComplete+'%'})}
thisS.totalProgress[ii]=percentComplete;var sum=arraySum(thisS.totalProgress)/(thisS.inProgress+thisS.successfulUpload);if(!thisS.options.preview){thisS.$element.find('#ssi-uploadProgressNoPreview').removeClass('ssi-hidden').css({width:sum+'%'})}
$uploadBtn.find('#ssi-up_loading').html(Math.ceil(sum)+'%')}},!1);return xhr},async:!0,beforeSend:function(xhr,settings){thisS.uploadList[ii]=xhr;$uploadBtn.find('#ssi-up_loading').html('<i class="fa fa-spinner fa-pulse"></i>');if(typeof thisS.options.beforeEachUpload==='function'){try{var msg=thisS.options.beforeEachUpload({name:thisS.toUpload[ii].name,type:thisS.toUpload[ii].type,size:(thisS.toUpload[ii].size/1024).toFixed(2)},xhr,settings)}catch(err){if(err.name=='Error'){thisS.abort(ii,undefined,err.message)}else{if(!thisS.options.ignoreCallbackErrors){console.log('There is an error in beforeEachUpload callback. Filename:'+thisS.toUpload[ii].name);console.log(err);thisS.abort(ii,undefined,thisS.language.wentWrong)}}
return}}
thisS.$element.find('input.ssi-uploadInput').trigger('beforeEachUpload.ssi-uploader');if(xhr.status===0){if(xhr.statusText==='canceled'){if(typeof msg==='undefined'){msg=!1}
thisS.abortedWithError++;thisS.abort(ii,msg)}}},type:'POST',data:formData,cache:!1,contentType:!1,processData:!1,url:thisS.options.url,error:function(request,error){if(error!=='abort'){uploadBar.addClass('ssi-canceledProgressBar');var msg=thisS.language.error;thisS.abortedWithError++;thisS.totalProgress.splice(ii,1);if(!thisS.options.preview){msg='<span class="exclamation7"></span>'}
setElementMessage(thisS,ii,'error',msg,thisS.language.serverError);thisS.totalProgress[ii]='';thisS.inProgress--;$clearBtn.prop("disabled",!1);if(typeof thisS.options.onEachUpload==='function'){try{thisS.options.onEachUpload({uploadStatus:'error',responseMsg:thisS.language.serverError,name:thisS.toUpload[ii].name,size:(thisS.toUpload[ii].size/1024).toFixed(2),type:thisS.toUpload[ii].type})}catch(err){if(!thisS.options.ignoreCallbackErrors){console.log('There is an error in onEachUpload callback. File name:'+thisS.toUpload[ii].name);console.log(err)}}}
if(getCompleteStatus(thisS)){finishUpload(thisS)}
console.log(arguments);console.log(" Ajax error: "+error)}}},thisS.options.ajaxOptions);$.ajax(ajaxOptions).done(function(responseData,textStatus,jqXHR){var msg,title='',dataType='error',spanClass='exclamation',data;try{data=$.parseJSON(responseData)}catch(err){data=responseData}
if(thisS.options.responseValidation){var valData=thisS.options.responseValidation;if(typeof valData.validationKey==='object'&&valData.resultKey=='validationKey'){if(data.hasOwnProperty(valData.validationKey.success)){cb(!0,data[valData.validationKey.success])}else{cb(!1,data[valData.validationKey.error])}}else{if(data[valData.validationKey]==valData.success){cb(!0,data[valData.resultKey])}else{cb(!1,data[valData.resultKey])}}}else{if(jqXHR.status==200){cb(!0,data)}else{cb(!1,data)}}
function cb(result,data){if(result){dataType='success';msg=thisS.language.success;spanClass='check';thisS.successfulUpload++}else{uploadBar.addClass('ssi-canceledProgressBar');if(thisS.options.preview){msg=thisS.language.error}
thisS.abortedWithError++}
title=data}
if(!thisS.options.preview){msg='<span class="'+spanClass+'7"></span>'}
setElementMessage(thisS,ii,dataType,msg,title);if(typeof thisS.options.onEachUpload==='function'){try{thisS.options.onEachUpload({uploadStatus:dataType,responseMsg:title,name:thisS.toUpload[ii].name,size:(thisS.toUpload[ii].size/1024).toFixed(2),type:thisS.toUpload[ii].type},data)}catch(err){console.log('There is an error in onEachUpload callback');console.log(err)}}
thisS.$element.find('input.ssi-uploadInput').trigger('onEachUpload.ssi-uploader');thisS.inProgress--;$clearBtn.prop("disabled",!1);if(getCompleteStatus(thisS)){finishUpload(thisS)}
thisS.uploadList[ii]='';thisS.toUpload[ii]='';thisS.imgNames[ii]=''});i=ii;i++;while(thisS.toUpload[i]===null||thisS.toUpload[i]===''){i++}
if(i<thisS.toUpload.length){formData=new FormData();$.each(thisS.options.data,function(key,value){formData.append(key,value)});formData.append(thisS.inputName,thisS.toUpload[i]);ajaxLoopRequest(formData,i)}}};var setElementMessage=function(thisS,index,msgType,msg,title){var className='',elementSelector='table.ssi-imgToUploadTable',element;if(!thisS.options.preview){className='ssi-noPreviewSubMessage';elementSelector='tr.ssi-toUploadTr';if(thisS.currentListLength===1){thisS.errors=title}}
element=thisS.$element.find(".ssi-abortUpload[data-delete='"+index+"']");element.parents(elementSelector).addClass('ssi-completed');element.after(getResultMessage(msgType,msg,title,className)).remove()};var getCompleteStatus=function(thisS){return(thisS.inProgress===0)};var getResultMessage=function(type,msg,title,classes){var callback_msg=title;var success_label_type='success';var error_label_type='error';var error_msg='File Upload Error';if(title==""){localStorage.setItem('callback',title);return'<span class="ssi-statusLabel '+classes+' '+success_label_type+'" data-status="'+title+'">'+msg+'</span>'}else{localStorage.setItem('callback',title);return'<span class="ssi-statusLabel '+classes+' '+error_label_type+'" data-status="'+title+'">'+error_msg+'</span>'}};var getCurrentListLength=function(thisS){return(thisS.inProgress+thisS.successfulUpload+thisS.aborted+thisS.abortedWithError+thisS.pending)};var setLastElementName=function(thisS){var fileName=thisS.$element.find('#ssi-fileList').find('span').html();var ext=fileName.getExtension();thisS.$element.find('.ssi-uploadDetails').removeClass('ssi-uploadBoxOpened');thisS.$element.find('.ssi-namePreview').html(cutFileName(fileName,ext,15))};Ssi_upload.prototype.abort=function(index,title,mmsg){if(typeof title==='undefined'){this.uploadList[index].abort();this.totalProgress[index]='';title=mmsg||'Aborted';this.aborted++}else if(typeof title!=='string'){title=''}
var msg=this.language.aborted;if(!this.options.preview){msg='<span class="ban7w"></span>'}
setElementMessage(this,index,'error',msg,(title));this.$element.find('#ssi-uploadProgress'+index).removeClass('ssi-hidden').addClass('ssi-canceledProgressBar');this.toUpload[index]=undefined;this.uploadList[index]=undefined;this.imgNames[index]=undefined;this.$element.find('#ssi-clearBtn').prop("disabled",!1);this.inProgress--;if(getCompleteStatus(this)){finishUpload(this)}};var finishUpload=function(thisS){thisS.$element.find('#ssi-abortBtn').addClass('ssi-hidden');if(!thisS.options.preview){var type='error',title='',msg='';if(thisS.abortedWithError>0){if(thisS.totalFilesLength===1){title=thisS.errors}else{title=thisS.language.someErrorsOccurred}
msg='<span class="exclamation23"></span>'}else if(thisS.aborted>0&&thisS.successfulUpload===0){msg='<span class="ban23"></span>';title=thisS.language.aborted}else if(thisS.successfulUpload>0){type='success';msg='<span class="check23"></span>';title=thisS.language.sucUpload}
thisS.$element.find('.ssi-namePreview').append(getResultMessage(type,msg,title,'ssi-noPreviewMessage'));thisS.$element.find('#ssi-uploadProgressNoPreview').removeAttr('styles').addClass('ssi-hidden')}
if(typeof thisS.options.onUpload==='function'){try{thisS.options.onUpload()}catch(err){if(!thisS.options.ignoreCallbackErrors){console.log('There is an error in onUpload callback');console.log(err)}}}
thisS.$element.find('input.ssi-uploadInput').trigger('onUpload.ssi-uploader');var $uploadBtn=thisS.$element.find('#ssi-uploadBtn');thisS.$element.find('#ssi-clearBtn').prop("disabled",!1);$uploadBtn.prop("disabled",!1).find('#ssi-up_loading').empty();if(thisS.pending===0){$uploadBtn.addClass('ssi-hidden');thisS.toUpload=[];thisS.imgNames=[];thisS.totalFilesLength=0}
thisS.uploadList=[];thisS.totalProgress=[];thisS.currentListLength=getCurrentListLength(thisS);thisS.inProgress=0};$.fn.ssi_uploader=function(opts){var defaults={url:'',data:{},locale:'en',preview:!0,dropZone:!0,maxNumberOfFiles:6,responseValidation:!1,ignoreCallbackErrors:!1,maxFileSize:5,ajaxOptions:{},onUpload:function(e){},onEachUpload:function(){},beforeUpload:function(){},beforeEachUpload:function(){},allowed:'',errorHandler:{method:function(msg){},success:'success',error:'error'}};var options=$.extend(!0,defaults,opts);options.allowed=options.allowed||['jpg','jpeg','png'];return this.each(function(){var $element=$(this);if($element.is('input[type="file"]')){if($element.data('ssi_upload'))return;var ssi_upload=new Ssi_upload(this,options);$element.data('ssi_upload',ssi_upload)}else{console.log('The targeted element is not file input.')}})};String.prototype.replaceText=function(){var args=Array.apply(null,arguments);var text=this;for(var i=0;i<args.length;i++){text=text.replace('$'+(i+1),args[i])}
return text};String.prototype.getExtension=function(){return this.split('.').pop().toLowerCase()};var cutFileName=function(word,ext,maxLength){if(typeof ext==='undefined')ext='';if(typeof maxLength==='undefined')maxLength=10;var min=4;if(maxLength<min)return;var extLength=ext.length;var wordLength=word.length;if((wordLength-2)>maxLength){word=word.substring(0,maxLength);var wl=word.length-extLength;word=word.substring(0,wl);return word+'...'+ext}else return word};var arraySum=function(arr){var sum=0;for(var i=0;i<arr.length;i++){if(typeof arr[i]==='number')
sum+=arr[i]}
return sum};var locale={en:{success:'Success',sucUpload:'Successful upload',chooseFiles:'Choose files',uploadFailed:'Upload failed',serverError:'Internal server error',error:'Error',abort:'Abort',aborted:'Aborted',files:'files',upload:'Upload',clear:'Clear',drag:'Drag n Drop',sizeError:'$1 exceed the size limit of $2',extError:'$1 file types are not supported',someErrorsOccurred:'Some errors occurred!',wentWrong:'Something went wrong!',pending:'Pending',completed:'Completed',inProgress:'In progress'},gr:{success:'Επιτυχία',sucUpload:'Επιτυχής μεταφόρτωση',chooseFiles:'Επιλέξτε αρχεία',uploadFailed:'Η μεταφόρτωση απέτυχε!',serverError:'Εσωτερικό σφάλμα διακομιστή!',error:'Σφάλμα',abort:'Διακοπή',aborted:'Διακόπηκε',files:'αρχεία',upload:'Μεταφόρτωση',clear:'Εκκαθάριση',drag:'Συρετε εδώ...',sizeError:'$1 έχει ξεπεράσει το όριο των $2.',extError:'$1 αρχεία δεν υποστηρίζονται.',someErrorsOccurred:'Σημειώθηκαν ορισμένα λάθη!',wentWrong:'Κάτι πήγε στραβά!',pending:'Σε εκκρεμότητα',completed:'Ολοκληρομένα',inProgress:'Σε εξέλιξη'},fr:{success:'Succès',sucUpload:'Envoi réussi',chooseFiles:'Choisissez fichiers',uploadFailed:'Envoi échoué',serverError:'Erreur interne du serveur',error:'Erreur',abort:'Annuler',aborted:'Annulé',files:'Fichiers',upload:'Envoyer',clear:'Effacer',drag:'Glisser déposer',sizeError:'$1 excède la taille limite de $2',extError:'Types de fichier $1 non autorisé',someErrorsOccurred:'Une erreur a eu lieu !',wentWrong:'Une erreur a eu lieu !',pending:'Εn attendant',completed:'Terminé',inProgress:'En cours'},zh_CN:{success:'上传成功',sucUpload:'上传成功',chooseFiles:'选择文件',uploadFailed:'上传失败',serverError:'服务器内部错误',error:'错误',abort:'中止',aborted:'已中止',files:'文件',upload:'上传',clear:'清空',drag:'将图片拖拽至此并释放',sizeError:'$1 超出了 $2 的大小限制',extError:'$1 类型不被支持',someErrorsOccurred:'发生了一些错误!',wentWrong:'出问题了哦!',pending:'等待上传',completed:'完成',inProgress:'正在上传'}}}))
